# 类型转换与运算符

## 自动(隐式)类型转换

C编译器会在操作数运算之前将所有操作数转为数值范围较大的操作数类型，称为**类型提升**

* 转换按数据长度增加的方向进行，以保证数值不失真，或者精度不降低
* char 和 short 参与运算时，会提升成 int 类型。称为**整数提升**
* 无符号和有符号的混合运算中，有符号类型会转换为无符号类型
* 浮点数赋给整型，该浮点数小数被舍去；
![alt:'typePromotion'](https://img-bc.icode.best/20200327214625196.png)
<small>自动(隐式)类型转换是编译器自动进行转换的，不会出现警告和错误；</small>

---

赋值语句中，类型转换会将右侧的值转为左侧变量的类型

```c
#include <stdio.h>

int main()
{
    int i;
    float f = 5.0;
    double d;
    i = f;
    f = i;
    d = f;
    printf("%d~%f~%f~%f" , i,f,d);
    //5~5.000000~5.000000
}
```

---

## 强制类型转换

强制类型转换能有效的避免数据丢失、类型溢出的隐患。

只需 (类型)表达式

```c
#include <stdio.h>

int main()
{
    int i = 5;
    float f = 1.9, f1 = 1.8;
    printf("%f\n", (float)(i / 2)); // 2.000000
    printf("%f\n", (float)i / 2);   // 2.500000 先将i转为float,i/2则自动转为float
    printf("%d\n", (int)(f + f1));  // 3 转为int类型会直接抹除小数取整
    printf("%d\n", (int)(f + f1)%2);// 1 %运算符两边均需为整型量 
}
```

---

## 运算符

* 优先级数字越低表示优先级越高
* 位运算符都以**二进制**为基进行计算
* 所有正整数的按位取反是其本身+1的负数，所有负整数的按位取反是其本身+1的绝对值，零的按位取反是 -1

|优先级|运算符|名称|形式|方向|说明|补充|
|:-------:|:-------:|:-------:|:-------:|:-------:|:-------:|:-------:|
|1|`[]`|数组下标|`arr[1]`|*左到右*|
|1|`()`|圆括号|`(a*b)/ fun(a,b)`|*左到右*||
|1|`.`|成员选择(对象)|`对象.成员名`|*左到右*|||
|1|`->`|成员选择(指针)|`对象指针->成员名`||||
|2|`-`|负号运算符|`-a`|右到左|单目||
|2|`(类型)`|强制类型转换|`(int)a`|||将a转换为int类型|
|2|`++`|自增运算符|`a++/++a`|右到左|单目||
|2|`--`|自减运算符|`a--/--a`|右到左|单目||
|2|`*`|取值运算符|`\*指针变量`|右到左|单目||
|2|`&`|取地址运算符|`&变量名`|右到左|单目||
|2|`!`|逻辑非运算符|`!(true)`|右到左|单目|逆转逻辑状态|
|2|`~`|按位取反运算符|`~表达式`|右到左|单目|二进制取反|
|2|`sizeof`|长度运算符|`sizeof(表达式)`||||
|3|`/`|除|`a/b`|*左到右*|双目||
|3|`*`|乘|`a\*b`|*左到右*|双目||
|3|`%`|余数(取模)|`a%b`|*左到右*|双目||
|4|`+`|加|`a+b`|*左到右*|双目||
|4|`-`|减|`a-b`|*左到右*|双目||
|5|`<<`|左移|`a<<2`|*左到右*|双目|二进制位左移2|
|5|`>>`|右移|`a>>3`|*左到右*|双目|二进制位右移3|
|6|`>`|大于|`a>b`|*左到右*|双目||
|6|`>=`|大于等于|`a>=b`|*左到右*|双目||
|6|`<`|小于|`a<b`|*左到右*|双目||
|6|`<=`|小于等于|`a<=b`|*左到右*|双目||
|7|`==`|等于|`a==b`|*左到右*|双目||
|7|`!=`|不等于|`a!=b`|*左到右*|双目||
|8|`&`|按位与||*左到右*|双目|都1则1|
|9|`^`|按位异或||*左到右*|双目|不同为1|
|10|`\|`|按位或||*左到右*|双目|有1则1|
|11|`&&`|逻辑与|`a && b`|*左到右*|双目|都真则真|
|12|`\|\|`|逻辑或|`a \|\| b`|*左到右*|双目|有假为假|
|13|`?:`|条件运算符|`a>b ? a=b : b=a`|右到左？|三目||
|14|`=`|赋值|`a=3`|右到左|||
|14|`/=`|除后赋值|`a/=3`|右到左|||
|14|`*=`|乘后赋值|`a\*=3`|右到左|||
|14|`%=`|取模后赋值|`a%=3`|右到左|||
|14|`+=`|加后赋值|`a+=3`|右到左|||
|14|`-=`|减后赋值|`a-=3`|右到左|||
|14|`<<=`|左移后赋值||右到左|||
|14|`>>=`|右移后赋值||右到左|||
|14|`&=`|按位与后赋值||右到左|||
|14|`^=`|按位异或后赋值||右到左|||
|14|`\`|按位或后赋值||右到左|||
|15|`,`|逗号运算符|`表达式,表达式,…`|*左到右*|||

---

1. 若已定义x和y为double类型，则表达式：x=1,y=x+3/2的值是(<small class="pass">2.0</small>)
2. 若t为double类型，表达式t=1,t+5,t++的值是(<small class="pass">1.0</small>)
