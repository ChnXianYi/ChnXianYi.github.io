# C程序设计(第四版-谭浩强)

## 第一章 程序设计和C语言

### 1.1 什么是计算机程序

所谓程序，就是一组计算机能识别和执行的命令

### 1.2 什么是计算机语言

* **机器语言**：计算机能够识别的长度16的二进制数(0,1)
    * 这些计算机能直接识别的二进制代码为**机器指令**
    * 机器指令集就是**机器语言**

* **符号语言**又称为**符号汇编语言/汇编语言**是由一些英文字母和数字表示一个指令

---

* 由于机器语言和汇编语言比较贴近计算机，因此也被归纳为**低级语言**

* 为了克服低级语言的缺点，20世纪50年代出现了第一个计算机高级语言。(FORTRAN)

* 由于这种语言功能性强，可以通过**编译程序**将高级语言编译的**源程序**编译为机器指令

---

### 1.3 C语言的发展及其特点

C是一种通用的编程语言，广泛用于系统软件与应用软件的开发。于1969年至1973年间，为了移植与开发UNIX操作系统，由丹尼斯·里奇与肯·汤普逊，以B语言为基础，在贝尔实验室设计、开发出来。

当前最新的 C 语言标准为 C18 ，在它之前的 C 语言标准有 C17、C11...C99 等。

特点：

* 语法限制不太严格，程序设计自由度大
* C允许直接访问物理地址。能进行位(bit)操作，可以直接对硬件进行操作
* 可移植性好
* 程序执行效率高

---

### 1.4 最简单的C语言程序

#### 例 1.1

```c
# include <stdio.h>

int main(){
    printf("This is a program.\n");
    return 0;
}
```

<output data-lang="output">
This is a program.
</output>

* `main`是主函数，每一个C语言程序都不必须有一个main函数
* `int`表示此函数的类型是int类型(整型)
* `# include <stdio.h>`提供编译系统要求的关于的函数的信息。
    * `stdio.h`是系统提供的一个文件名，stdio是'standard input'&'output'的缩写。
    * `.h`的意思是头文件(header file)
    * 编译器需要的输入输出函数的相关信息已事先存放在stdio.h文件中。因此，在程序中如要用到标准函数库的的函数，需在文件头部写上`# include <stdio.h>`

<small>C99建议把main函数指定为int型，它要求返回一个整数值。当主函数正常结束时，得到的函数为0.错误时为一个非0的整数.可以通过返回值来判断main函数是否正常执行</small>

---

#### 例 1.2

```c
# include <stdio.h>

int main(){
    int a , b ,sum;
    a = 123,
    b = 456;
    sum = a + b;
    printf("sum is %d\n",sum);
    return 0;
}
```

<output data-lang="output">
sum is 579
</output>

* `%d`在printf库函数中为**以十进制形式输出带符号整数(正数不输出符号)**

---

#### 例 1.3

```c
#include <stdio.h>

int main()
{
    int max(int x, int y);
    int a, b, c;
    scanf("%d,%d", &a, &b);
    c = max(a, b);
    printf("max= %d\n", c);
    return 0;
}
int max(int x, int y)
{
    int z;
    if (x > y)
        z = x;
    else
        z = y;
    return z;
}
```

<output data-lang="output">

8,5

  max=8

</output>

* `scanf`输入变量a,b的值
* `&a`是变量a的地址

---

### 1.4.2 C语言程序的结构

* 一个程序由一个或多个源程序文件组成
    * 预处理指令 如`#include <stdio.h>`
    * 全局声明
    * 函数定义
* 函数是C语言程序的主要组成部分
* 一个函数包含两部分
    * 函数首部
    * 函数体
* 程序总是从main函数开始执行的
* 程序中对计算机的操作是由函数中的C语句完成的
* 在每个数据声明和语句的最后必须有一个分号
* C语言本身不提供输入输出语句(依赖scanf/printf)
* 程序应当包含注释

---

### 1.5 运行C程序的步骤与方法

如何运行

1. 编译源程序文件 (e.c)
2. 对源程序进行编译
3. 进行连接处理
4. 运行可执行文件

---

### 1.6 程序设计的任务

1. 问题分析
2. 设计算法
3. 编写程序
4. 对源程序进行编辑，编译和连接
5. 运行程序，分析结果
6. 编写程序文档

---

## 第二章 算法——程序的灵魂

### 2.1 什么是算法

算法（Algorithm）是指解题方案的准确而完整的描述

---

### 2.2 简单的算法举例

#### 例 2.5 判断一个大于或等于3的正整数是否为素数

* 只需判断是否能被 2~√N 之间的整数整除

### 2.3 算法的特性

* 有穷性
* 确定性
* 有零个或多个输入
* 有一个或多个输出
* 有效性

---

### 2.4 怎样表示一个算法

流程图…………

---

### 2.5 结构化程序设计方法

…………

## 第三章 最简单的C程序设计-顺序程序设计

### 3.1 顺序程度设计举例

#### 例 3.1

将温度计测量出用华氏法表示的温度转化为摄氏度

华氏度转为摄氏度的公式为 `c=5/9(f-32)`

```c
# include <stdio.h>

int main()
{
    float f , c; // 声明浮点型变量或函数返回值类型
    f = 64.0;
    c = (5.0/9) * (f-32);
    printf("f=%f\nc=%f\n",f,c);
    return 0;
}
```

<output data-lang="output">

  f=64.000000

  c=17.777779

</output>

---

#### 例 3.2

计算存款利息。1000元分别活期年利率r1,一年定期r2,两次半年定期r3.计算出一年后按3种方法所得到的本金和利息和

```c
# include <stdio.h>

int main()
{
    float p0 = 1000, r1 = 0.0036 , r2 = 0.0225 , r3 = 0.0198 , p1 , p2 , p3;
    p1 = p0*(1+r1);
    p2 = p0*(1+r2);
    p3 = p0*(1+r3);
    printf("p1=%f\np2=%f\np3=%f" , p1 , p2 , p3);
    return 0;
}
```

<output data-lang="output">

  p1=1003.599976

  p2=1022.500061

  p3=1019.799927

</output>

---

### 3.2 数据的表现形式及其运算

#### 3.2.1 常量和变量

在计算机高级语言中，数据有两种表现形式：常量和变量

##### 常量

在程序运行过程中，其值不能被改变的量称为常量。

1. 整型常量：通常的整数，包括正整数、负整数和0
2. 实型常量：又称实数或浮点数。 在C语言中可以用单精度型和双精度型两种形式表示实型常量，分别用类型名float和double进行定义 。
    * 十进制小数形式：123.456；0.789
    * 指数形式：
        * 12.34e5(12.34*10^5)
        * 0.14E-25(0.14*10^(-25))
3. 字符常量：一对单撇号括起来的字符序列
    * 普通字符："a","1"
    * 转义字符：以字符`\`开头的字符序列

---

转义字符及其作用

|转义字符|含义|输出|
|:-------:|:-------:|:-------:|
|`\'`|'字符|\'|
|`\"`|"字符|\"|
|`\?`|?字符|\?|
|`\\`|\字符|\\|
|`\a`|警告(alert)|产生声音或视觉信号|
|`\b`|退格符 (backspace)|将当前位置后退一个字符|
|`\f`|换页符 (form feed)|将当前位置移到下一页的开头|
|`\n`|换行符|将当前位置移到下一行的开头|
|`\r`|回车符 (carriage return)|将当前位置移到本行的开头|
|`\t`|水平制表符|将当前位置移到下一个tab位置|
|`\v`|垂直制表符|将当前位置移到下一个垂直制表对齐点|
|`\0`(0代表一个八进制数字)|转换为对应的ASCII字符||
|`\xh[0……]`(0代表一个十六进制数字)|转换为对应的ASCII字符||

---

4. 字符串常量：用双撇号把若干个字符括起来

!> 单撇号只是界限符。单撇号内只能包含一个字符，双撇号内可以包含字符串

5. 符号常量：用`# define`指令，指定用一个符号名称代表一个常量
    * `# define PI 3.1416`,文件将会从此行开始所有的PI都代表3.1416.
    * 符号常量通常用大写表示

---

##### 变量

一个有名字的，具有特定属性的一个存储单元。用来存放数据

变量必须**先定义，后使用**

---

##### 常变量

`const int a = 3;`

将a被定义为一个整型变量，指定值为3.且在变量存在期间其值不能改变

##### 标识符

在计算机高级语言中，用来对变量，符号常量名，函数，数组，类型等命名的有效字符序列统称为**标识符**

C语言规定标识符只能由字母、数字、下划线三种字符组成，且第一个字符必须为字母或下划线

---

#### 3.2.2 数据类型

在 C 语言中，数据类型指的是用于声明不同类型的变量或函数的一个广泛的系统。变量的类型决定了变量存储占用的空间，以及如何解释存储的位模式。

数据类型分为 基本类型 、 枚举类型(enum) 、 空类型(void) 、 派生类型

其中**基本类型**分为：

* 整型类型
    * 基本整型(int)
    * 短整型(short int)
    * 长整型(long int)
    * 双长整型(long long int)
    * 字符型(char)
    * 布尔型(bool)
* 浮点类型
    * 单精度浮点型(float)
    * 双精度浮点型(double)
    * 复数浮点型(float_complex,double_comple,long long_comple)

**派生类型**则分为：

* 指针类型(*)
* 数组类型([])
* 结构体类型(struct)
* 共用体类型(union)
* 函数类型()

---

#### 3.2.3 整型数据

##### 整型数据的分类

1. 基本整型(int)

编译系统分配给int型数据2个字节或4个字节(由系统位数决定)

2. 短整型(short int)

类型名为short int 或 short

3. 长整型(long int)

类型名为long int 或 long

4. 双长整型(long long int)

类型名为long long int 或 long long,一般分配8个字节。是C99新增的类型，许多C编译系统尚未实现

---

##### 整型变量的符号属性

整型数据常见的存储空间和值的范围

|类型|字节数|取值范围|
|:-------:|:-------:|:-------:|
|int(基本整型)|2|-32,768 ~ 32,767|
|int(基本整型)|4|-2,147,483,648 ~ 2,147,483,647|
|unsigned int(无符号基本整型)|2|0 ~ 65,535|
|unsigned int(无符号基本整型)|4|0 ~ 4,294,967,295|
|short(短整型)|2|-32,768 ~ 32,767|
|unsigned short(无符号短整型)|2|0 ~ 65,535|
|long(长整型)|4|-2,147,483,648 ~ 2,147,483,647|
|unsigned long(无符号长整型)|4|0 ~ 4,294,967,295|
|long long(双长整型)|8|-9223372036854775808 ~ 9223372036854775807|
|unsigned long long(无符号双长整型)|8|0 ~ 18446744073709551615|

---

在实际应用中，有的数据的范围常常只有正值，为了充分利用变量的值的范围，可以将变量定义为`无符号类型`。在类型符号前加上修饰符`unsigned`，表示该变量是无符号整数类型，如果加上`signed`则是有符号类型

在默认情况下，变量类型前会有`signed`,但一般省略不写

---

#### 3.2.4 字符型数据

##### 字符与字符代码

目前大多数系统采用 ASCII 字符集，其中包括

* 字母：大写英文字母A~Z，小写英文字母a~z
* 数字：0~9
* 专门符号：29个：!"#&'()*+,-./:;<=>?[]\^_`{}|~
* 空格符：空格、水平制表符、垂直制表符、换行符、换页符
* 不能显示的字符：空(null)字符 *'\0'表示* 警告 *'\a'表示* 退格 *'\b'表示* 回车 *'\r'表示*

---

##### 字符变量

字符变量是用类型符 `char` 定义字符变量，char是英文 character 的缩写

如：`char c = '?'`

定义c为字符型变量且赋值'?',字符?的ASCII代码为 63

在输出字符时可以选择输出形式，如`printf(%d %c\n , c,c);` 输出 `63 ?`

其中字符型数据的存储空间和值的范围是

|类型|字节数|取值范围|
|:-------:|:-------:|:-------:|
|signed char|1|-128 ~ 127|
|char|1|0 ~ 255|

<small>当 char c =255,时，常整数255超过了取值范围，系统给出warning,但 unsigned char c = 255,则不会报出警告</small>

---

#### 3.2.5 浮点型数据

浮点型数据是用来表示具有小数点的实数的。

---

##### float 单精度浮点型

float数据在存储时会将数据分为小数部分和指数部分分别存储

如`3.14159`会分为 `.3.14159` 和 `10^1` 分别存储

---

##### double 双精度浮点型

是float扩大后的浮点型，在C语言中进行浮点数运算时，会自动将float类型的浮点型数值自动转换为 double

---

##### long double 长双精度浮点型

不同的编译系统会对 long double 型的分配字节数不同 (8/16)

---

|类型|字节数|有效数字|数值范围(绝对值)|
|:-------:|:-------:|:-------:|:-------:|
|float|4|6|0以及 1.2×10^-38 ~ 3.4×10^38|
|double|8|15|0以及 2.3×10^-308 ~ 1.7×10^308|
|long double|8|15|0以及 2.3×10^-308 ~ 1.7×10^308|
|long double|16|19|0以及 3.4×10^-4932 ~ 1.1×10^4932|

---

#### 3.2.6 怎样确定常量的类型

* 不带小数点的数值是整型常量
* 由单撇号或双撇号括起来的字符就是字符常量
* 整数的末尾有大写字母L或小写字母l的就是长整型
* 以小数形式或指数形式出现的则是浮点型
* 可以在常量的末尾加专用字符，强调指定常量的类型
    * 3.14159f 就表示是float类型

---

#### 3.2.7 运算符和表达式

##### 基本的算术运算符

|运算符|含义|举例|结果|
|:-------:|:-------:|:-------:|:-------:|
|+|正号运算符(单目运算符)|+a|a的值|
|-|负号运算符(单目运算符)|-a|a的算术负值|
|*|乘法运算符|a * b|a和b的乘积|
|/|除法运算符|a/b|a除以b的商|
|%|求余运算符|a%b|a除以b的余数|
|+|加法运算符|a+b|a加b的和|
|-|减法运算符|a-b|a和b的差|

---

##### 自增、自减运算符

* i++ 在使用i之后，i的值+1
* ++i 在使用i之前，i的值+1

---

##### 算术表达式和运算符的优先级和结合性

……

---

##### 不同类型数据间的混合运算

如果一个运算符的两侧数据类型不同，则自动进行类型转换，使二者具有同一种类型

* float 与 double 运算会先转为double型在进行计算
* int 与 float 或 double 运算会先把int型转为浮点型再进行运算
* char 与 整型数据 运算会char类型的值先转为ASCII代码再进行运算

---

#### 例 3.3

给一个大写字母，要求输出小写字母

<small>ASCII编码中，同一个字母，小写字符的编码比大写字母大32</small>

```c
# include <stdio.h>

int main()
{
    char c1 , c2;
    c1 = 'A';
    c2 = c1 + 32;
    printf("%c\n" , c2);
    return 0;
}
```

<output data-lang="output">
a
</output>

---

##### 强制类型转换运算符

* (double)a 将a强制转换为double类型
* (int)(x+y)
* (float)(5%3)

一般形式为 (类型名)(表达式)

---

##### C运算符

除了算术运算符意外，C还提供其他运算符

* 算术运算符 (+ - * / % ++ --)
* 关系运算符 (> < == >= <= !=)
* 逻辑运算符 (!&& ||)
* 位运算符 (<< >> ~ | ^ &)
* 赋值运算符 (=)
* 条件运算符 (?:)
* 逗号运算符 (,)
* 指针运算符 (* &)
* 求字节数运算符 (sizeof)
* 强制类型转换运算符 ( (类型) )
* 成员运算符 (. ->)
* 下标运算符 ([])
* 其他

---

### 3.3 C 语句

#### 3.3.1 C 语句的作用和分类

##### 控制语句

1. if()...else...
2. for()...
3. while()...
4. do...while()
5. continue
6. break
7. switch
8. return
9. goto

---

##### 函数调用语句

函数调用语句由一个函数调用加一个分号构成

---

##### 表达式语句

表达式语句由一个表达式加一个分号构成

---

##### 空语句

`;`

此语句只有一个分号，可以用来作为流程的转向点，也可用来作为循环语句中的循环体

---

##### 复合语句

用{}把一些语句和声明括起来成为复合语句(语句块)

---

#### 3.3.2 最基本的语句————赋值语句

#### 例 3.4

给出三角形的三边长，求三角形面积。使用海伦公式：

![alt:'math'](https://wikimedia.org/api/rest_v1/media/math/render/svg/f74fc858aefe5838ff272e10c0c4746b3d40c327)

其中{\displaystyle s}s 是三角形的半周长，a、b和c是三角形三条边的长度。

```c
# include <stdio.h>
# include <math.h>

int main()
{
    double a , b , c , s , area;
    a = 3.67;
    b = 5.43;
    c = 6.21;
    s = (a + b + c)/2;
    area=sqrt(s*(s-a)*(s-b)*(s-c));
    printf("a=%f\tb=%f\tc=%f\n" , a , b , c);
    printf("area=%f\n" , area);
    return 0;
}
```

<output data-lang="output">

a=3.670000  b=5.430000  c=6.210000

area=9.903431

</output>

* #include <math.h> 引入数学函数库
* sqrt函数求平方根

---

##### 赋值表达式

* 赋值运算符： = 就是将一个数据赋给一个变量
* 复合的赋值运算符： a += 3 等价于 a=a+3
* 赋值表达式： a=b=c=5 全都=5
* 赋值过程中的类型转换：
    * float 转换为 int, 浮点数值舍弃小数值。3.999 => 3
    * int 转为为浮点数, 3 => 3.0
    * double 转为 float, 应注意双精度数值的大小不能超出float的数值范围,如果超出，将会输出错误的信息
    * char 转为 整型变量, i="A" , i=字母A的ASCII代码65
* 赋值表达式： if(a>0) max = a;
* 变量赋初值： int a = 3; int b,c = 5;*只有c赋值了5，b还未被赋值*

---

### 3.4 数据的输入输出

#### 3.4.1 输入输出举例

#### 例 3.5

求ax^2 + bx + c = 0 方程的根。a,b,c由键盘键入，设b^2-4ac > 0.

```c
# include <stdio.h>
# include <math.h>

int main()
{
    double a , b , c , disc , x1 , x2 , p , q;
    scanf("%lf%lf%lf" , &a , &b , &c);
    disc = b * b - 4 * a * c;
    p = -b / (2.0 * a);
    q = sqrt(disc)/(2.0 * a);
    x1 = p+q; x2 = p-q;
    printf("x1=%7.2f\nx2=%7.2f\n" , x1 , x2);
    return 0;
}
```

<output data-lang="output">

1 3 2

x1=  -1.00

x2=  -2.00

</output>

* scanf函数获取键入值，&表示内存地址
* `%lf` 要求输入三个实数，double
* `%7.2f` 指定数据占7列，其中小数占2列(第三位按四舍五入处理)

---

#### 3.4.2 有关数据输入输出的概念

1. 输入输出是对计算机主机而言的，输出到显示器等，键盘输入等
2. C语言本身不提供输入输出语句，输入和输出操作是由C标准函数库中的函数来实现的。(printf、scanf)
3. 在使用系统函数库时，要在程序开头用预处理指令 # include 把有关头文件引入
    * `<stdio.j>` 是标注方式，只会按标准方式查找。
    * `"stdio.h"` 双撇号形式，会先在用户的当前目录寻找用户自己编写的文件，如果找不到，再按标准方式查找

---

#### 3.4.3 用printf函数输出数据

##### printf函数的一般格式

`printf("%d,%c\n" , i,c)`

1. `"..."` 双撇号内的字符串称为**转换控制字符串**简称**格式字符串**
2. `%...` 格式声明：将输出的数据转换为指定的格式然后输出
3. `, a , b` 输出表列*按顺序填充%*

---

##### 格式字符

1. d格式符 : 用来输出一个有符号的十进制整数，可以在格式声明中指定输出的宽度 `%5d`
    * `printf("%5d" , 1)` 输出结果为`    1`
2. c格式符 ： 用来输出**一个**字符.同样支持指定宽度 `%5c`
    * 当以c格式符输出整数时，会输出该整数作为ASCII码所对应的字符
        * `short a = 121; printf("%c" , a)` 输出 `y`
        * `int a = 377; printf("%c" , a)` 输出 `y` , 因为%c只考虑一个字节，所以只输出整数最后一个字节的信息。01111001,所对应的ASCII码是'y'
3. s格式符 ：用来输出一个字符串
4. f格式符 ：用来输出实数(单双精度，长双精度值)，以小数形式输出
    * `%f`计算double1/3，输出 `0.333333`
    * 指定数据宽度和小数位数：`%20.15f`计算double1/3，输出`   0.333333333333333`
    * 输出数据向左对齐 ：`%20.15f`计算double1/3，输出`0.333333333333333   `
